@model denemekicin1.Models.Randevu

@{
    ViewData["Title"] = "Randevu Ekle";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>@ViewData["Title"]</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Raleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i" rel="stylesheet" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="css/styles.css" rel="stylesheet" />
    <link href="~/css/styles.css" rel="stylesheet" />
    <script src="~/js/scripts.js"></script>
</head>

<body style="background-image: url('/assets/img/d.jpg'); background-size: cover; background-repeat: no-repeat; background-position: center;">

    <header>
        <h1 class="site-heading text-center text-faded d-none d-lg-block">
            <span class="site-heading-upper text-primary mb-3">Randevu Sistemi</span>
            <span class="site-heading-lower">Randevu Ekle</span>
        </h1>
    </header>

    <section class="page-section cta">
        <div class="container">
            <div class="row">
                <div class="col-xl-9 mx-auto">
                    <div class="cta-inner bg-faded text-center rounded">
                        <h2 class="section-heading mb-5">
                            <span class="section-heading-upper">Randevu Detayları</span>
                        </h2>
                        @if (TempData["msj"] != null)
                        {
                            <div class="alert alert-warning">@TempData["msj"]</div>
                        }

                        <form asp-action="RandevuKaydet2" method="post">

                            <div class="form-group">
                                <label asp-for="HesapID" class="control-label">Hesap ID</label>
                                <input asp-for="HesapID" class="form-control" readonly />
                                <span asp-validation-for="HesapID" class="text-danger"></span>
                            </div>

                            <div class="form-group">
                                <label asp-for="RandevuGun" class="control-label">Gün Seçimi</label>
                                <select asp-for="RandevuGun" class="form-control">
                                    <option value="Pazartesi">Pazartesi</option>
                                    <option value="Salı">Salı</option>
                                    <option value="Çarşamba">Çarşamba</option>
                                    <option value="Perşembe">Perşembe</option>
                                    <option value="Cuma">Cuma</option>
                                </select>
                                <span asp-validation-for="RandevuGun" class="text-danger"></span>
                            </div>

                            <div class="form-group">
                                <label asp-for="RandevuSaat" class="control-label">Saat Seçimi</label>
                                <select asp-for="RandevuSaat" class="form-control" id="RandevuSaat">
                                    @for (int i = 7; i <= 18; i++)
                                    {
                                        <option value="@i">@i:00</option>
                                    }
                                </select>
                                <span asp-validation-for="RandevuSaat" class="text-danger"></span>
                            </div>

                            <div class="form-group">
                                <label class="control-label">Saç İşlemleri</label>
                                <div>
                                    <div class="form-check">
                                        <input type="radio" name="SacIslemleri" class="form-check-input sac-islemi" value="Kesim - 500" data-sure="1">
                                        <label class="form-check-label">Kesim - 500 TL (1 saat)</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="radio" name="SacIslemleri" class="form-check-input sac-islemi" value="Boya - 1000" data-sure="3">
                                        <label class="form-check-label">Boya - 1000 TL (3 saat)</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="radio" name="SacIslemleri" class="form-check-input sac-islemi" value="Fon - 250" data-sure="1">
                                        <label class="form-check-label">Fon - 250 TL (1 saat)</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="radio" name="SacIslemleri" class="form-check-input sac-islemi" value="Perma - 1000" data-sure="2">
                                        <label class="form-check-label">Perma - 1000 TL (2 saat)</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="radio" name="SacIslemleri" class="form-check-input sac-islemi" value="Brezilya Fönü - 700" data-sure="1">
                                        <label class="form-check-label">Brezilya Fönü - 700 TL (1 saat)</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="radio" name="SacIslemleri" class="form-check-input sac-islemi" value="Saç Bakımı - 1200" data-sure="2">
                                        <label class="form-check-label">Saç Bakımı - 1200 TL (2 saat)</label>
                                    </div>
                                    <div class="form-check">
                                        <input type="radio" name="SacIslemleri" class="form-check-input sac-islemi" value="Saç Düzleştirme - 200" data-sure="1">
                                        <label class="form-check-label">Saç Düzleştirme - 200 TL (1 saat)</label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label asp-for="CalisanID" class="control-label">Çalışan Seçimi</label>
                                <select asp-for="CalisanID" class="form-control" id="CalisanID">
                                    <option value="">Çalışan Seçin</option>
                                    @foreach (var calisan in ViewBag.Calisanlar)
                                    {
                                        <option value="@calisan.CalisanID" data-alan="@calisan.alan">@calisan.CalisanAd</option>
                                    }
                                </select>
                                <span asp-validation-for="CalisanID" class="text-danger"></span>
                            </div>

                            <div id="randevuBilgileri" class="alert alert-info mt-3" style="display:none;">
                                <strong>Randevu Bilgileri:</strong>
                                <p>Toplam Tutar: <span id="toplamTutar">-</span></p>
                                <p>İşlem Süresi: <span id="islemSuresi">-</span> saat</p>
                                <p>Bitiş Saati: <span id="randevuBitisSaati">-</span></p>
                            </div>

                            <button type="submit" class="btn btn-primary">Randevu Kaydet</button>
                        </form>

                        @section Scripts {
                            <partial name="_ValidationScriptsPartial" />
                            <script>
                                document.querySelectorAll(".sac-islemi").forEach(radio => {
                                    radio.addEventListener("change", function () {
                                        const secilenAlan = this.value.split(" - ")[0];
                                        const calisanlar = document.querySelectorAll("#CalisanID option");

                                        calisanlar.forEach(option => {
                                            if (option.getAttribute("data-alan") && option.getAttribute("data-alan").includes(secilenAlan)) {
                                                option.style.display = "block";
                                            } else {
                                                option.style.display = "none";
                                            }
                                        });

                                        const ilkUygunCalisan = Array.from(calisanlar).find(option => option.style.display === "block");
                                        if (ilkUygunCalisan) {
                                            ilkUygunCalisan.selected = true;
                                        }
                                    });
                                });

                                document.querySelectorAll(".sac-islemi").forEach(radio => {
                                    radio.addEventListener("change", function () {
                                        const fiyat = this.value.split(" - ")[1].trim();
                                        const sure = parseInt(this.getAttribute("data-sure"));
                                        const saat = parseInt(document.getElementById("RandevuSaat").value);

                                        const bilgiDiv = document.getElementById("randevuBilgileri");
                                        bilgiDiv.style.display = "block";

                                        document.getElementById("toplamTutar").innerText = fiyat;
                                        document.getElementById("islemSuresi").innerText = sure;

                                        if (!isNaN(saat) && !isNaN(sure)) {
                                            const bitisSaati = saat + sure;
                                            document.getElementById("randevuBitisSaati").innerText = bitisSaati + ":00";
                                        } else {
                                            document.getElementById("randevuBitisSaati").innerText = "-";
                                        }
                                    });
                                });
                            </script>
                        }

                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer text-faded text-center py-5">
        <div class="container"><p class="m-0 small">Kadıköy Güzellik Merkezi 2024</p></div>
        <div class="container"><p class="m-0 small">Adres: Bahariye Caddesi No: 123, Kadıköy, İstanbul</p></div>
        <div class="container"><p class="m-0 small">Telefon: +90 216 555 1234</p></p></div>
        <div class="container"><p class="m-0 small">E-posta: info@kadikoyguzellikmerkezi.com</p></div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/scripts.js"></script>

</body>
</html>
